:root {
  --bg:#0f1115; --fg:#e8eaed; --muted:#a7b0be; --accent:#6ee7ff;
  --panel-bg:#161a23; --panel-border:#242a36;
  --canvas-bg:#0a0c10; --canvas-border:#202533;
  --stat-bg:#0d1119; --stat-border:#1f2533;
  --button-bg:#121722; --button-border:#2a3142; --button-hover-bg:#1a2030;
  --button-primary-bg:color-mix(in srgb,var(--accent) 92%,#0b1019 8%);
  --button-primary-border:color-mix(in srgb,var(--accent) 55%,#02060b 45%);
  --button-primary-hover-bg:color-mix(in srgb,var(--accent) 100%,#060b15 0%);
  --button-primary-color:#03121f;
  --button-primary-shadow:0 14px 32px color-mix(in srgb,var(--accent),transparent 70%);
  --button-primary-hover-shadow:0 18px 38px color-mix(in srgb,var(--accent),transparent 60%);
  --kbd-bg:#222739; --kbd-border:#2c3550;
  --mini-bg:#0d1119; --mini-border:#1f2533;
  --input-bg:#0d1119; --input-border:#1f2533;
  --table-head-bg:#0d1119; --table-even-bg:#0f1521; --table-border:#1f2533;
  --sudoku-block-border:color-mix(in srgb,var(--accent) 55%,transparent 45%);
}
.theme-light {
  --bg:#ffffff; --fg:#202124; --muted:#5f6368; --accent:#0066cc;
  --panel-bg:#f1f3f4; --panel-border:#dadce0;
  --canvas-bg:#ffffff; --canvas-border:#dadce0;
  --stat-bg:#f1f3f4; --stat-border:#dadce0;
  --button-bg:#f8f9fa; --button-border:#dadce0; --button-hover-bg:#e8eaed;
  --button-primary-bg:#0b62d1;
  --button-primary-border:#0a58bb;
  --button-primary-hover-bg:#0a58bb;
  --button-primary-color:#ffffff;
  --button-primary-shadow:0 12px 28px color-mix(in srgb,#0b62d1,transparent 65%);
  --button-primary-hover-shadow:0 16px 34px color-mix(in srgb,#0b62d1,transparent 55%);
  --kbd-bg:#e8eaed; --kbd-border:#dadce0;
  --mini-bg:#f1f3f4; --mini-border:#dadce0;
  --input-bg:#f8f9fa; --input-border:#dadce0;
  --table-head-bg:#f1f3f4; --table-even-bg:#f8f9fa; --table-border:#dadce0;
  --sudoku-block-border:color-mix(in srgb,var(--accent) 70%,transparent 30%);
}
html,body{height:100%;margin:0;background-color:var(--bg);background-image:linear-gradient(135deg,color-mix(in srgb,var(--bg),#fff 5%),color-mix(in srgb,var(--bg),#000 5%));color:var(--fg);font:400 16px/1.4 'Inter',system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;overflow-x:hidden;overflow-y:auto}
.wrap{max-width:980px;margin:24px auto;padding:0 16px;display:grid;grid-template-columns:1fr auto;gap:24px}
h1{font-size:28px;letter-spacing:1px;margin:0 0 8px;font-weight:600}
p{color:var(--muted);margin:0 0 12px}
.grid{display:grid;grid-template-columns:minmax(0,360px) repeat(2,minmax(0,1fr));gap:16px;align-items:start}
.game-area{display:flex;flex-direction:column;gap:8px;align-items:center}
@media (max-width:720px){
  .wrap{grid-template-columns:1fr}
  .grid{grid-template-columns:1fr}
  .board-wrap{max-width:90vw}
}
.panel{background:color-mix(in srgb,var(--panel-bg),transparent 20%);backdrop-filter:blur(8px);border:1px solid var(--panel-border);border-radius:16px;padding:14px 16px;box-shadow:0 10px 30px color-mix(in srgb,var(--bg),#000 30%);min-width:0}
canvas{display:block;background:var(--canvas-bg);border-radius:12px;border:1px solid var(--canvas-border)}
#snakeCanvas{touch-action:none;-webkit-user-select:none;user-select:none}
.stats{display:flex;flex-direction:column;gap:8px}
.stat{background:var(--stat-bg);border:1px solid var(--stat-border);border-radius:12px;padding:10px;text-align:center}
.stat b{display:block;font-size:22px;margin-top:6px;color:var(--accent);font-weight:600;letter-spacing:1px}
.buttons{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
button{cursor:pointer;border:1px solid var(--button-border);background:var(--button-bg);color:var(--fg);padding:10px 14px;border-radius:12px;touch-action:manipulation;transition:background .2s ease,transform .1s ease;display:flex;align-items:center;gap:4px}
button:hover{background:var(--button-hover-bg)}
button:active{transform:scale(.96)}
button .material-icons{font-size:20px}
button:focus-visible{outline:2px solid var(--accent);outline-offset:2px}
kbd{background:var(--kbd-bg);border:1px solid var(--kbd-border);border-bottom-width:3px;border-radius:6px;padding:2px 6px;margin:0 2px}
ul{padding-left:18px;margin:6px 0}
.mini{background:var(--mini-bg);border:1px solid var(--mini-border);border-radius:12px;padding:6px}
.footer{grid-column:1/-1;color:var(--muted);margin-top:8px}
.tag{font-size:12px;color:var(--muted)}
.controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:10px 0}
.top-controls{margin-bottom:8px;gap:8px;flex-wrap:wrap}
.input{background:var(--input-bg);border:1px solid var(--input-border);border-radius:10px;padding:8px 10px;color:var(--fg)}
select.input{background:var(--input-bg);border:1px solid var(--input-border);color:var(--fg)}
select.input option{background:var(--input-bg);color:var(--fg)}
.table{width:100%;border-collapse:collapse;margin-top:8px}
.table th,.table td{border:1px solid var(--table-border);padding:8px;text-align:left}
.table thead th{background:var(--table-head-bg);color:var(--muted)}
.table tbody tr:hover{background:color-mix(in srgb,var(--table-head-bg),transparent 60%)}
.table tbody tr:nth-child(even){background:var(--table-even-bg)}
#hsTable td:nth-child(1),
#hsTable td:nth-child(3),
#hsTable td:nth-child(4),
#snakeScoreTable td:nth-child(1),
#snakeScoreTable td:nth-child(3),
#snakeHsTable td:nth-child(1),
#snakeHsTable td:nth-child(3),
#sudokuScoreTable td:nth-child(1),
#sudokuScoreTable td:nth-child(3),
#sudokuOvTable td:nth-child(1),
#sudokuOvTable td:nth-child(3){text-align:right}
/* Menu Overlay */
#menuOverlay{position:fixed;inset:0;overflow-y:auto;background:rgba(0,0,0,.6);padding:24px 16px;opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:9998}
#menuOverlay.show{opacity:1;pointer-events:auto}
#menuOverlay [role="tablist"] button.active{background:var(--button-hover-bg)}
#menuOverlay .menu-overlay__inner{max-width:720px;margin:0 auto;display:flex;flex-direction:column;gap:16px}
#menuOverlay .menu-overlay__inner .controls{justify-content:center}
#menuOverlay .panel{width:100%;box-sizing:border-box}
/* Overlay Game Over */
#overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .25s ease;background:rgba(0,0,0,.45);backdrop-filter:blur(2px) saturate(1.1);z-index:9999}
#overlay.show{opacity:1;pointer-events:auto}
#overlay .overlay-card{background:var(--stat-bg);border:1px solid var(--stat-border);border-radius:16px;padding:20px 22px;min-width:320px;max-width:90vw;animation:pop .3s ease-out}
#overlay h2{margin:0 0 6px;font-weight:600;letter-spacing:1px}
#snakeOverlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .25s ease;background:rgba(0,0,0,.45);backdrop-filter:blur(2px) saturate(1.1);z-index:9999}
#snakeOverlay.show{opacity:1;pointer-events:auto}
#snakeOverlay .overlay-card{background:var(--stat-bg);border:1px solid var(--stat-border);border-radius:16px;padding:20px 22px;min-width:320px;max-width:90vw;animation:pop .3s ease-out}
#snakeOverlay h2{margin:0 0 6px;font-weight:600;letter-spacing:1px}
#sudokuOverlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .25s ease;background:rgba(0,0,0,.45);backdrop-filter:blur(2px) saturate(1.1);z-index:9999}
#sudokuOverlay.show{opacity:1;pointer-events:auto}
#sudokuOverlay .overlay-card{background:var(--stat-bg);border:1px solid var(--stat-border);border-radius:16px;padding:20px 22px;min-width:320px;max-width:90vw;animation:pop .3s ease-out}
#sudokuOverlay h2{margin:0 0 6px;font-weight:600;letter-spacing:1px}
@keyframes pop{from{transform:scale(.95);opacity:.6} to{transform:scale(1);opacity:1}}
/* Pause Overlay */
.board-wrap{position:relative;touch-action:none;width:100%;max-width:300px;margin:0 auto}
#game{width:100%;height:auto}
#pauseOverlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:48px;letter-spacing:2px;color:var(--fg);background:rgba(0,0,0,.35);opacity:0;pointer-events:none;transition:opacity .2s ease;border-radius:12px}
#pauseOverlay.show{opacity:1}
.hidden{display:none!important}
.timer{font-weight:700; font-size:18px; color:var(--accent)}
[aria-label]::before,[aria-label]::after{display:none;content:none}
dialog{border:1px solid var(--panel-border);background:var(--panel-bg);color:var(--fg);border-radius:12px;padding:16px}
dialog::backdrop{background:rgba(0,0,0,.45)}
#introScreen{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.55);backdrop-filter:blur(6px);z-index:10000;transition:opacity .3s ease,visibility .3s ease}
#introScreen.hide{opacity:0;visibility:hidden;pointer-events:none}
#introScreen .intro-card{background:color-mix(in srgb,var(--panel-bg),transparent 10%);border:1px solid var(--panel-border);border-radius:20px;padding:28px 32px;max-width:420px;margin:16px;box-shadow:0 18px 40px color-mix(in srgb,var(--bg),#000 40%);text-align:center}
#introScreen h1{margin:0 0 8px;font-size:30px;letter-spacing:1px}
#introScreen p{margin:0 0 20px;color:var(--muted)}
.intro-form{display:flex;flex-direction:column;gap:16px}
.intro-label{display:flex;flex-direction:column;gap:6px;text-align:left;font-weight:600}
.intro-label .input{width:100%}
.intro-submit{align-self:center;font-size:16px;padding:12px 20px}
.intro-submit .material-icons{font-size:22px}
.button-primary{background:var(--button-primary-bg);border:1px solid var(--button-primary-border);color:var(--button-primary-color);box-shadow:var(--button-primary-shadow);transition:background .2s ease,transform .1s ease,box-shadow .2s ease}
.button-primary:hover{background:var(--button-primary-hover-bg);box-shadow:var(--button-primary-hover-shadow);transform:translateY(-1px)}
.button-primary:active{transform:scale(.95)}
.sudoku-panel{display:flex;flex-direction:column;align-items:center;gap:16px}
.sudoku-stats{gap:16px}
.sudoku-grid{position:relative;width:clamp(280px,calc(100vw - 32px),520px);aspect-ratio:1;display:grid;grid-template-columns:repeat(9,1fr);background:var(--canvas-bg);border:2px solid var(--canvas-border);border-radius:16px;overflow:hidden;box-shadow:0 10px 30px color-mix(in srgb,var(--bg),#000 30%)}
.sudoku-grid::before{content:"";position:absolute;inset:0;pointer-events:none;background:
  repeating-linear-gradient(90deg,transparent,transparent calc(33.333% - 1.5px),var(--sudoku-block-border) calc(33.333% - 1.5px),var(--sudoku-block-border) calc(33.333% + 1.5px)),
  repeating-linear-gradient(0deg,transparent,transparent calc(33.333% - 1.5px),var(--sudoku-block-border) calc(33.333% - 1.5px),var(--sudoku-block-border) calc(33.333% + 1.5px));
  border-radius:inherit;
}
.sudoku-cell{border:1px solid color-mix(in srgb,var(--canvas-border),transparent 35%);font-size:clamp(18px,3.5vw,24px);font-weight:500;display:flex;align-items:center;justify-content:center;background:color-mix(in srgb,var(--panel-bg),transparent 30%);color:var(--fg);transition:background .2s ease,color .2s ease,box-shadow .2s ease;padding:0}
.sudoku-cell:disabled{cursor:default}
.sudoku-cell.fixed{background:color-mix(in srgb,var(--panel-bg),transparent 10%);color:var(--muted);font-weight:600}
.sudoku-cell.filled{color:var(--fg)}
.sudoku-cell.has-notes{font-weight:400;font-size:0.65em}
.sudoku-cell.highlight-row:not(.selected):not(.error),
.sudoku-cell.highlight-col:not(.selected):not(.error),
.sudoku-cell.highlight-block:not(.selected):not(.error){background:color-mix(in srgb,var(--accent),transparent 88%)}
.sudoku-cell.highlight-number:not(.selected):not(.error){box-shadow:0 0 0 2px color-mix(in srgb,var(--accent),transparent 35%) inset}
.sudoku-cell.selected{background:color-mix(in srgb,var(--accent),transparent 70%);box-shadow:0 0 0 2px var(--accent) inset}
.sudoku-cell.error{background:color-mix(in srgb,#b00020,transparent 68%);color:#fff;box-shadow:0 0 0 2px #b00020 inset;animation:sudoku-error .35s ease}
.sudoku-cell.border-top{border-top-width:2px}
.sudoku-cell.border-left{border-left-width:2px}
.sudoku-cell.border-right{border-right-width:2px}
.sudoku-cell.border-bottom{border-bottom-width:2px}
.sudoku-notes{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(3,1fr);width:100%;height:100%;gap:1px}
.sudoku-notes span{display:flex;align-items:center;justify-content:center;font-size:clamp(11px,2vw,14px);color:var(--muted)}
.sudoku-pad{display:flex;flex-direction:column;gap:12px;width:clamp(280px,calc(100vw - 32px),520px)}
.sudoku-pad-keys{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
.sudoku-pad button{font-size:clamp(16px,3.2vw,20px);padding:10px;border-radius:10px}
.sudoku-pad button.selected{background:color-mix(in srgb,var(--accent),transparent 75%);box-shadow:0 0 0 2px var(--accent) inset}
.sudoku-pad-tools{display:flex;gap:8px;flex-wrap:wrap}
.sudoku-toggle{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;font-size:clamp(14px,2.6vw,18px);padding:10px 12px;border-radius:12px;border:1px solid color-mix(in srgb,var(--canvas-border),transparent 15%);background:color-mix(in srgb,var(--panel-bg),transparent 10%);transition:background .2s ease,box-shadow .2s ease}
.sudoku-toggle[aria-pressed="true"]{background:color-mix(in srgb,var(--accent),transparent 75%);box-shadow:0 0 0 2px var(--accent) inset}
.sudoku-pad-clear{display:flex;align-items:center;justify-content:center;gap:6px;font-size:clamp(14px,2.6vw,18px);border-radius:12px;border:1px solid color-mix(in srgb,var(--canvas-border),transparent 15%);background:color-mix(in srgb,var(--panel-bg),transparent 10%)}
.sudoku-pad-clear .material-icons{font-size:1.2em}
.sudoku-progress{display:flex;flex-direction:column;align-items:center;gap:6px;font-size:clamp(12px,2.4vw,15px);color:var(--muted)}
.sudoku-progress-bar{width:120px;max-width:22vw;height:6px;border-radius:999px;overflow:hidden;background:color-mix(in srgb,var(--panel-bg),transparent 35%);border:1px solid color-mix(in srgb,var(--canvas-border),transparent 25%)}
.sudoku-progress-bar #sudokuProgressFill{width:0;height:100%;background:var(--accent);transition:width .25s ease}
@keyframes sudoku-error{0%,100%{background:color-mix(in srgb,#b00020,transparent 75%);color:var(--fg)}50%{background:#b00020;color:#fff}}
