<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Tetris ‚Äì Vanilla JS (Einzeldatei) + Scoreboard</title>
  <!-- iOS/PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#0f1115" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-180.png" />
  <style>
    :root {
      --bg:#0f1115; --fg:#e8eaed; --muted:#a7b0be; --accent:#6ee7ff;
      --panel-bg:#161a23; --panel-border:#242a36;
      --canvas-bg:#0a0c10; --canvas-border:#202533;
      --stat-bg:#0d1119; --stat-border:#1f2533;
      --button-bg:#121722; --button-border:#2a3142; --button-hover-bg:#1a2030;
      --kbd-bg:#222739; --kbd-border:#2c3550;
      --mini-bg:#0d1119; --mini-border:#1f2533;
      --input-bg:#0d1119; --input-border:#1f2533;
      --table-head-bg:#0d1119; --table-even-bg:#0f1521; --table-border:#1f2533;
    }
    .theme-light {
      --bg:#ffffff; --fg:#202124; --muted:#5f6368; --accent:#0066cc;
      --panel-bg:#f1f3f4; --panel-border:#dadce0;
      --canvas-bg:#ffffff; --canvas-border:#dadce0;
      --stat-bg:#f1f3f4; --stat-border:#dadce0;
      --button-bg:#f8f9fa; --button-border:#dadce0; --button-hover-bg:#e8eaed;
      --kbd-bg:#e8eaed; --kbd-border:#dadce0;
      --mini-bg:#f1f3f4; --mini-border:#dadce0;
      --input-bg:#f8f9fa; --input-border:#dadce0;
      --table-head-bg:#f1f3f4; --table-even-bg:#f8f9fa; --table-border:#dadce0;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font:500 16px/1.4 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;overflow-x:hidden;overflow-y:auto}
    .wrap{max-width:980px;margin:24px auto;padding:0 16px;display:grid;grid-template-columns:1fr auto;gap:24px}
    h1{font-size:28px;margin:0 0 8px}
    p{color:var(--muted);margin:0 0 12px}
    .grid{display:grid;grid-template-columns:320px 160px;gap:16px;align-items:start}
    .game-area{display:flex;gap:16px;align-items:flex-start}
    @media (max-width:720px){
      .wrap{grid-template-columns:1fr}
      .grid{grid-template-columns:1fr}
      .mobile-controls{display:grid}
      .game-area{flex-direction:column;align-items:center}
    }
    .panel{background:var(--panel-bg);border:1px solid var(--panel-border);border-radius:16px;padding:14px 16px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
    canvas{display:block;background:var(--canvas-bg);border-radius:12px;border:1px solid var(--canvas-border)}
    .stats{display:flex;flex-direction:column;gap:8px}
    .stat{background:var(--stat-bg);border:1px solid var(--stat-border);border-radius:12px;padding:10px;text-align:center}
    .stat b{display:block;font-size:22px;margin-top:6px;color:var(--accent)}
    .buttons{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{cursor:pointer;border:1px solid var(--button-border);background:var(--button-bg);color:var(--fg);padding:10px 14px;border-radius:12px}
    button:hover{background:var(--button-hover-bg)}
    kbd{background:var(--kbd-bg);border:1px solid var(--kbd-border);border-bottom-width:3px;border-radius:6px;padding:2px 6px;margin:0 2px}
    ul{padding-left:18px;margin:6px 0}
    .next-hold{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
    .mini{background:var(--mini-bg);border:1px solid var(--mini-border);border-radius:12px;padding:6px}
    .footer{grid-column:1/-1;color:var(--muted);margin-top:8px}
    .tag{font-size:12px;color:var(--muted)}
    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:10px 0}
    .top-controls{margin-bottom:8px}
    .input{background:var(--input-bg);border:1px solid var(--input-border);border-radius:10px;padding:8px 10px;color:var(--fg)}
    .table{width:100%;border-collapse:collapse;margin-top:8px}
    .table th,.table td{border:1px solid var(--table-border);padding:8px;text-align:left}
    .table thead th{background:var(--table-head-bg);color:var(--muted)}
    .table tbody tr:nth-child(even){background:var(--table-even-bg)}
    /* Menu Overlay */
    #menuOverlay{position:fixed;inset:0;overflow-y:auto;background:rgba(0,0,0,.6);padding:24px 16px;opacity:0;pointer-events:none;transition:opacity .25s ease;z-index:9998}
    #menuOverlay.show{opacity:1;pointer-events:auto}
    /* Overlay Game Over */
    #overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .25s ease;background:rgba(0,0,0,.45);backdrop-filter:blur(2px) saturate(1.1);z-index:9999}
    #overlay.show{opacity:1;pointer-events:auto}
    #overlay .overlay-card{background:var(--stat-bg);border:1px solid var(--stat-border);border-radius:16px;padding:20px 22px;min-width:320px;max-width:90vw;animation:pop .3s ease-out}
    #overlay h2{margin:0 0 6px}
    @keyframes pop{from{transform:scale(.95);opacity:.6} to{transform:scale(1);opacity:1}}
    /* Pause Overlay */
    .board-wrap{position:relative;touch-action:none}
    #pauseOverlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:48px;letter-spacing:2px;color:var(--fg);background:rgba(0,0,0,.35);opacity:0;pointer-events:none;transition:opacity .2s ease;border-radius:12px}
    #pauseOverlay.show{opacity:1}
    /* Mobile touch controls */
    .mobile-controls{display:none;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px}
    .mobile-controls button{padding:12px 10px;font-size:16px;border-radius:12px}
    .timer{font-weight:700; font-size:18px; color:var(--accent)}
  </style>
</head>
<body>
  <div class="wrap">
    <div>
      <h1>üß± Tetris</h1>
      <p class="tag">Vanilla¬†JavaScript ‚Ä¢ Canvas ‚Ä¢ Level/Score/Lines ‚Ä¢ Soft/Hard¬†Drop ‚Ä¢ Pause ‚Ä¢ Hold ‚Ä¢ 7‚ÄëBag¬†RNG</p>
      <div class="controls top-controls">
        <button id="btnMenu">Men√º</button>
        <button id="themeToggle">Theme</button>
        <label>Modus:
          <select id="modeSelect">
            <option value="classic">Classic (endlos)</option>
            <option value="ultra">Ultra ‚Äì 2 Minuten</option>
          </select>
        </label>
      </div>
      <div class="grid">
        <div class="panel">
          <div class="controls" style="margin:0 0 8px">
            <span class="timer" id="timer" style="margin-left:auto"></span>
          </div>
          <div class="game-area">
            <div class="board-wrap">
              <canvas id="game" width="300" height="600" aria-label="Tetris Board"></canvas>
              <div id="pauseOverlay" aria-hidden="true">PAUSE</div>
            </div>
            <div class="stats">
              <div class="stat">Score<b id="score">0</b></div>
              <div class="stat">Best<b id="best">0</b></div>
            </div>
          </div>
          <div class="buttons">
            <button id="btnStart">Start/Neu</button>
            <button id="btnPause">Pause</button>
            <button id="btnHard">Hard¬†Drop (Leertaste)</button>
          </div>
          <div class="tag" id="comboTag"></div>
        </div>
          <div class="mobile-controls" aria-label="Touch Controls">
            <button id="mLeft">‚óÄÔ∏é</button>
            <button id="mRotate">‚ü≥</button>
            <button id="mRight">‚ñ∂Ô∏é</button>
            <button id="mHold">HOLD</button>
            <button id="mSoft">Soft ‚Üì</button>
            <button id="mHard">HARD ‚§ì</button>
            <button id="mPause">Pause</button>
            <button id="mStart">Neu</button>
          </div>
        </div>
        <div class="panel"><div class="next-hold">
            <div>
              <div class="tag">N√§chstes</div>
              <canvas id="next" class="mini" width="120" height="120"></canvas>
            </div>
            <div>
              <div class="tag">Hold (<kbd>Shift</kbd>)</div>
              <canvas id="hold" class="mini" width="120" height="120"></canvas>
            </div>
          </div>
          <h3>Steuerung</h3>
          <ul>
            <li><kbd>‚Üê</kbd>/<kbd>‚Üí</kbd>: bewegen</li>
            <li><kbd>‚Üì</kbd>: schneller fallen (Soft¬†Drop)</li>
            <li><kbd>‚Üë</kbd> oder <kbd>W</kbd>: rotieren (im Uhrzeigersinn)</li>
            <li><kbd>Leertaste</kbd>: Hard¬†Drop</li>
            <li><kbd>Shift</kbd>: Hold tauschen</li>
            <li><kbd>P</kbd>: Pause</li>
          </ul>
        </div>
      </div>

    </div>

  <div class="panel">
      <h3>Hinweise</h3>
      <ul>
        <li>Level steigt alle 10 Lines ‚Üí schnellere Fallgeschwindigkeit.</li>
        <li>Punkte: Single¬†=¬†100, Double¬†=¬†300, Triple¬†=¬†500, Tetris¬†=¬†800, Soft‚ÄëDrop¬†+1/Zelle, Hard‚ÄëDrop¬†+2/Zelle.</li>
        <li>Rotation: vereinfachtes SRS; Wandkicks an W√§nden und Stacks.</li>
      </ul>
    </div>

    <div class="footer">¬© 2025 ‚Äì Einzeldatei. Speichere diese Seite als <code>tetris.html</code> und √∂ffne sie im Browser.</div>
  </div>

  <div id="menuOverlay" aria-hidden="true">
    <button id="btnMenuClose" style="position:absolute;top:16px;right:16px">Schlie√üen</button>
    <div class="buttons" style="justify-content:center;margin:24px 0;">
      <button id="tabScore">Scoreboard</button>
      <button id="tabSettings">Einstellungen</button>
    </div>
    <div class="panel" id="scorePanel" style="margin-top:16px;">
      <h3>Scoreboard</h3>
      <div class="controls">
        <label for="playerName">Name:</label>
        <input id="playerName" class="input" placeholder="Dein Name" maxlength="16" />
        <button id="btnResetHS">Highscores l√∂schen</button>
      </div>
      <table class="table" id="hsTable">
        <thead>
          <tr><th>#</th><th>Name</th><th>Score</th><th>Lines</th><th>Level</th><th>Datum</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="panel" id="settingsPanel" style="margin-top:16px;display:none;">
      <h3>Einstellungen</h3>
      <div class="controls">
        <label><input type="checkbox" id="optSound" checked> Sound</label>
        <label><input type="checkbox" id="optGhost" checked> Ghost Piece</label>
        <label><input type="checkbox" id="optSoftDropPoints" checked> Soft‚ÄëDrop Punkte</label>
        <label>Farben:
          <select id="optPalette">
            <option value="standard">Standard</option>
            <option value="accessible">Barrierefrei</option>
          </select>
        </label>
      </div>
    </div>
  </div>

  <!-- Game Over Overlay -->
  <div id="overlay" aria-hidden="true">
    <div class="overlay-card" role="dialog" aria-modal="true" aria-labelledby="ovTitle">
      <h2 id="ovTitle">Game Over</h2>
      <p class="tag">Gut gespielt ‚Äì weiter geht's?</p>
      <div class="stats" style="margin-top:8px">
        <div class="stat">Score<b id="ovScore">0</b></div>
        <div class="stat">Lines<b id="ovLines">0</b></div>
        <div class="stat">Level<b id="ovLevel">0</b></div>
        <div class="stat">Best<b id="ovBest">0</b></div>
      </div>
      <div class="buttons" style="justify-content:center;margin-top:14px">
        <button id="btnRestart">Neu starten</button>
        <button id="btnClose">Schlie√üen</button>
      </div>
    </div>
  </div>

  <script src="tetris.js"></script>
</body>
</html>
